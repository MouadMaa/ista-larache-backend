# Migration `20200926133232-remove-modulesonclasses-model`

This migration has been generated by mouadmaa at 9/26/2020, 2:32:32 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
DROP INDEX "public"."Module.number_formationId_unique"

ALTER TABLE "public"."ModulesOnClasses" DROP CONSTRAINT "ModulesOnClasses_classId_fkey"

ALTER TABLE "public"."ModulesOnClasses" DROP CONSTRAINT "ModulesOnClasses_moduleId_fkey"

ALTER TABLE "public"."_ClassToModule" DROP CONSTRAINT "_ClassToModule_A_fkey"

ALTER TABLE "public"."_ClassToModule" DROP CONSTRAINT "_ClassToModule_B_fkey"

CREATE UNIQUE INDEX "Module.number_name_formationId_unique" ON "public"."Module"("number", "name", "formationId")

DROP TABLE "public"."ModulesOnClasses"

DROP TABLE "public"."_ClassToModule"
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200926122352-use-little-to-teacher-property..20200926133232-remove-modulesonclasses-model
--- datamodel.dml
+++ datamodel.dml
@@ -2,9 +2,9 @@
 // learn more about it in the docs: https://pris.ly/d/prisma-schema
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
@@ -31,9 +31,8 @@
 model Class {
   id          String    @id @default(cuid())
   year        Year      @default(Premiere)
   group       Group     @default(A)
-  modules     Module[]
   formation   Formation @relation(fields: [formationId], references: [id])
   formationId String
   teacher     User      @relation(fields: [teacherId], references: [id])
   teacherId   String
@@ -44,24 +43,14 @@
 model Module {
   id          String    @id @default(cuid())
   number      Int
   name        String
-  classes     Class[]
   formation   Formation @relation(fields: [formationId], references: [id])
   formationId String
-  @@unique([number, formationId])
+  @@unique([number, name, formationId])
 }
-model ModulesOnClasses {
-  class     Class  @relation(fields: [classId], references: [id])
-  classId   String
-  module    Module @relation(fields: [moduleId], references: [id])
-  moduleId  String
-
-  @@id([classId, moduleId])
-}
-
 enum Role {
   ADMIN
   TEACHER
 }
```


